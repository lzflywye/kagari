<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <title>パスワード変更</title>
    <style>
        body {
            font-family: sans-serif;
            background-color: #f4f4f9;
            color: #333;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
        }

        .container {
            background-color: #fff;
            padding: 2rem;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 400px;
        }

        h1 {
            text-align: center;
            color: #4CAF50;
        }

        form div {
            margin-bottom: 1rem;
        }

        label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: bold;
        }

        input[type="password"] {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
        }

        .error-message {
            color: #d9534f;
            background-color: #f2dede;
            border: 1px solid #ebccd1;
            padding: 0.75rem 1.25rem;
            margin-bottom: 1rem;
            border-radius: 4px;
        }

        button {
            width: 100%;
            padding: 0.75rem;
            background-color: #5cb85c;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: bold;
        }

        button:hover {
            background-color: #4cae4c;
        }
    </style>
</head>

<body>

    <div class="container">
        <h1>パスワード変更</h1>

        {#if error}
        <div class="error-message">
            {#if error == 'password_mismatch'}
            新しいパスワードと確認用パスワードが一致しません。
            {#else if error == 'incorrect_password'}
            現在のパスワードが正しくありません。
            {#else if error == 'invalid_password'}
            新しいパスワードが要件を満たしていません。
            {#else}
            パスワード変更に失敗しました。
            {/if}
        </div>
        {/if}

        <form id="password-change-form" action="/change-password" method="POST">
            <div>
                <label for="current-password">現在のパスワード</label>
                <input type="password" id="current-password" name="currentPassword" required>
            </div>

            <div>
                <label for="new-password">新しいパスワード</label>
                <input type="password" id="new-password" name="newPassword" required minlength="8" maxlength="255"
                    pattern="(?=.*[a-z])(?=.*[A-Z])(?=.*\d).\{8,}" title="8文字以上、大文字・小文字・数字をそれぞれ1つ以上含めてください。"
                    autocomplete="new-password">
            </div>

            <div>
                <label for="confirm-password">新しいパスワード（確認用）</label>
                <input type="password" id="confirm-password" name="confirmPassword" required minlength="8"
                    maxlength="255" pattern="(?=.*[a-z])(?=.*[A-Z])(?=.*\d).\{8,}"
                    title="8文字以上、大文字・小文字・数字をそれぞれ1つ以上含めてください。" autocomplete="new-password">
            </div>

            <button type="submit">パスワードを変更</button>
        </form>
    </div>

    <script>
        const form = document.getElementById("password-change-form");
        const newPassword = document.getElementById("new-password");
        const confirmPassword = document.getElementById("confirm-password");
        form.onsubmit = function () {
            confirmPassword.setCustomValidity("");
            if (newPassword.value != confirmPassword.value) {
                confirmPassword.setCustomValidity("パスワードと確認用パスワードが一致しません");
            }
        }
    </script>
</body>

</html>